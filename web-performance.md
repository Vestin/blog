---
layout: blog
title: 负载均衡
date: 2017-11-27 14:37:43
tags:
- 性能优化
- 架构
---

负载均衡
---
当单机负载不能满足服务需求，就需要多台服务器来处理。负载均衡起到调度服务器，分配服务处理量的作用。

---
## DNS负载均衡（不推荐使用）
基本用法
### 多个Ａ记录轮旬
```
A->127.0.0.2
A->127.0.0.3
A->127.0.0.4
...
```

### 智能解析
就近解析

DNS负载均衡的优势
* 扩展性 -> 扩容方便
* 易用性 -> 操作简单
劣势
* 灵活性不够　
DNS有缓存时间，出故障后，修改ＤＮＳ记录需要时间长，下线服务时间长
* 策略局限性
    * 权重调整等不能被支持

### 反向代理负载均衡
本质
* 应用层的负载均衡
* http请求转发
    * 任何对于实际服务器的HTTP请求都必须经过调度器
    * 调度器必须等待实际服务器的HTTP响应，并将它发送给用户

优势：
* 扩展性强
* 权重调整
劣势
* 性能瓶颈受反向代理服务器的性能限制
    * 最大吞吐率　约等于　反向代理服务器的最大吞吐率

### ip负载均衡
* 应用层下的负载均衡
* 可以支持更多的网络协议（FTP/SMTP/DNS/VOIP/流媒体)

#### DNAT(反向NAT)
NAT(Network Address Translation)

#### LVS
Liunx Virtual Server

### Direct Route(直接路由)
* 数据链路层
通过修改数据包的目标mac地址，将数据包转发到实际服务器。不经过调度器
